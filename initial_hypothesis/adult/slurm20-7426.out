2021-04-15 20:32:03.572172: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Torch is available: True
torch.cuda.current_device(): 0
torch.cuda.device_count(): 1
torch.cuda.get_device_name(): Tesla T4
batch number: 2
Created directory.
Size of full dataset: (48841, 15)
age               0
workclass         0
fnlwht            0
education         0
education-num     0
marital-status    0
occupation        0
relationship      0
race              0
sex               0
capital-gain      0
capital-loss      0
hours-per-week    0
native-country    0
income            0
dtype: int64
   workclass_Federal-gov  workclass_Local-gov  ...  sex_Female  sex_Male
0                      0                    0  ...           0         1
1                      0                    0  ...           0         1
2                      0                    0  ...           0         1
3                      0                    0  ...           1         0
4                      0                    0  ...           1         0

[5 rows x 98 columns]
   age  education-num  capital-gain  ...  race_White  sex_Female  sex_Male
0   50             13             0  ...           1           0         1
1   38              9             0  ...           1           0         1
2   53              7             0  ...           0           0         1
3   28             13             0  ...           0           1         0
4   37             14             0  ...           1           1         0

[5 rows x 103 columns]
len(idx_train): 36825
len(idx_test): 9207
Training non-private model...
Non-private model training on 20 epochs done in  0:00:24.133975  seconds
Training model -1:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0

Test set: Average loss: 0.3338, Accuracy: 7777/9207 (84%)

Original model accuracy: 0.8446833930704899

Test set: Average loss: 0.4564, Accuracy: 7567/9207 (82%)

Full private model accuracy: 0.821874660584338
Training model 1060:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 7668:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 8962:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 14448:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 14755:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 15568:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 16044:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 16738:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 18137:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 20415:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 27206:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0

Test set: Average loss: 0.4734, Accuracy: 7552/9207 (82%)

Model 1060 accuracy: 0.8202454654067557

Test set: Average loss: 0.4633, Accuracy: 7571/9207 (82%)

Model 7668 accuracy: 0.8223091126316933

Test set: Average loss: 0.4680, Accuracy: 7556/9207 (82%)

Model 8962 accuracy: 0.820679917454111

Test set: Average loss: 0.4768, Accuracy: 7552/9207 (82%)

Model 14448 accuracy: 0.8202454654067557

Test set: Average loss: 0.4552, Accuracy: 7580/9207 (82%)

Model 14755 accuracy: 0.8232866297382426

Test set: Average loss: 0.4775, Accuracy: 7537/9207 (82%)

Model 15568 accuracy: 0.8186162702291735

Test set: Average loss: 0.4611, Accuracy: 7581/9207 (82%)

Model 16044 accuracy: 0.8233952427500815

Test set: Average loss: 0.4708, Accuracy: 7558/9207 (82%)

Model 16738 accuracy: 0.8208971434777886

Test set: Average loss: 0.4558, Accuracy: 7590/9207 (82%)

Model 18137 accuracy: 0.8243727598566308

Test set: Average loss: 0.4714, Accuracy: 7542/9207 (82%)

Model 20415 accuracy: 0.8191593352883676

Test set: Average loss: 0.4730, Accuracy: 7564/9207 (82%)

Model 27206 accuracy: 0.8215488215488216
Training time: 0:07:06.576628
Thu Apr 15 20:40:00 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 460.39       Driver Version: 460.39       CUDA Version: 11.2     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:0D.0 Off |                    0 |
| N/A   54C    P0    29W /  70W |      0MiB / 15109MiB |      1%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 20:40:00 up 14 days,  6:32,  2 users,  load average: 14.77, 14.84, 14.08
