2021-04-15 11:13:17.416944: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Torch is available: True
torch.cuda.current_device(): 0
torch.cuda.device_count(): 1
torch.cuda.get_device_name(): Tesla T4
batch number: 1
Created directory.
Size of full dataset: (48841, 15)
age               0
workclass         0
fnlwht            0
education         0
education-num     0
marital-status    0
occupation        0
relationship      0
race              0
sex               0
capital-gain      0
capital-loss      0
hours-per-week    0
native-country    0
income            0
dtype: int64
   workclass_Federal-gov  workclass_Local-gov  ...  sex_Female  sex_Male
0                      0                    0  ...           0         1
1                      0                    0  ...           0         1
2                      0                    0  ...           0         1
3                      0                    0  ...           1         0
4                      0                    0  ...           1         0

[5 rows x 98 columns]
   age  education-num  capital-gain  ...  race_White  sex_Female  sex_Male
0   50             13             0  ...           1           0         1
1   38              9             0  ...           1           0         1
2   53              7             0  ...           0           0         1
3   28             13             0  ...           0           1         0
4   37             14             0  ...           1           1         0

[5 rows x 103 columns]
Training non-priavte model...
Epoch  1 :

Test set: Average loss: 0.5419, Accuracy: 6815/9207 (74%)

Epoch  2 :

Test set: Average loss: 0.4844, Accuracy: 7235/9207 (79%)

Epoch  3 :

Test set: Average loss: 0.4514, Accuracy: 7427/9207 (81%)

Epoch  4 :

Test set: Average loss: 0.4281, Accuracy: 7530/9207 (82%)

Epoch  5 :

Test set: Average loss: 0.4101, Accuracy: 7602/9207 (83%)

Epoch  6 :

Test set: Average loss: 0.3954, Accuracy: 7654/9207 (83%)

Epoch  7 :

Test set: Average loss: 0.3835, Accuracy: 7688/9207 (84%)

Epoch  8 :

Test set: Average loss: 0.3738, Accuracy: 7702/9207 (84%)

Epoch  9 :

Test set: Average loss: 0.3657, Accuracy: 7721/9207 (84%)

Epoch  10 :

Test set: Average loss: 0.3590, Accuracy: 7744/9207 (84%)

Epoch  11 :

Test set: Average loss: 0.3536, Accuracy: 7755/9207 (84%)

Epoch  12 :

Test set: Average loss: 0.3491, Accuracy: 7768/9207 (84%)

Epoch  13 :

Test set: Average loss: 0.3454, Accuracy: 7768/9207 (84%)

Epoch  14 :

Test set: Average loss: 0.3424, Accuracy: 7768/9207 (84%)

Epoch  15 :

Test set: Average loss: 0.3400, Accuracy: 7766/9207 (84%)

Epoch  16 :

Test set: Average loss: 0.3381, Accuracy: 7770/9207 (84%)

Epoch  17 :

Test set: Average loss: 0.3365, Accuracy: 7776/9207 (84%)

Epoch  18 :

Test set: Average loss: 0.3352, Accuracy: 7774/9207 (84%)

Epoch  19 :

Test set: Average loss: 0.3342, Accuracy: 7769/9207 (84%)

Epoch  20 :

Test set: Average loss: 0.3334, Accuracy: 7773/9207 (84%)

Non-private model training on 20 epochs done in  26.055434465408325  seconds
Training private model...
Epoch  1 :

Test set: Average loss: 0.6173, Accuracy: 6466/9207 (70%)

Epoch  2 :

Test set: Average loss: 0.5732, Accuracy: 6737/9207 (73%)

Epoch  3 :

Test set: Average loss: 0.5719, Accuracy: 6841/9207 (74%)

Epoch  4 :

Test set: Average loss: 0.5720, Accuracy: 6934/9207 (75%)

Epoch  5 :

Test set: Average loss: 0.5717, Accuracy: 7023/9207 (76%)

Epoch  6 :

Test set: Average loss: 0.5702, Accuracy: 7093/9207 (77%)

Epoch  7 :

Test set: Average loss: 0.5651, Accuracy: 7132/9207 (77%)

Epoch  8 :

Test set: Average loss: 0.5603, Accuracy: 7178/9207 (78%)

Epoch  9 :

Test set: Average loss: 0.5554, Accuracy: 7212/9207 (78%)

Epoch  10 :

Test set: Average loss: 0.5476, Accuracy: 7239/9207 (79%)

Epoch  11 :

Test set: Average loss: 0.5410, Accuracy: 7279/9207 (79%)

Epoch  12 :

Test set: Average loss: 0.5336, Accuracy: 7317/9207 (79%)

Epoch  13 :

Test set: Average loss: 0.5270, Accuracy: 7356/9207 (80%)

Epoch  14 :

Test set: Average loss: 0.5203, Accuracy: 7400/9207 (80%)

Epoch  15 :

Test set: Average loss: 0.5099, Accuracy: 7436/9207 (81%)

Epoch  16 :

Test set: Average loss: 0.5025, Accuracy: 7458/9207 (81%)

Epoch  17 :

Test set: Average loss: 0.4937, Accuracy: 7487/9207 (81%)

Epoch  18 :

Test set: Average loss: 0.4865, Accuracy: 7524/9207 (82%)

Epoch  19 :

Test set: Average loss: 0.4799, Accuracy: 7548/9207 (82%)

Epoch  20 :

Test set: Average loss: 0.4728, Accuracy: 7569/9207 (82%)

Private model training on 20 epochs done in  32.35223174095154  seconds

Test set: Average loss: 0.3334, Accuracy: 7773/9207 (84%)

Original model accuracy: 0.8442489410231345

Test set: Average loss: 0.4728, Accuracy: 7569/9207 (82%)

Full private model accuracy: 0.8220918866080157
Thu Apr 15 11:14:28 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 460.39       Driver Version: 460.39       CUDA Version: 11.2     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:0D.0 Off |                    0 |
| N/A   50C    P0    28W /  70W |      0MiB / 15109MiB |     30%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 11:14:28 up 13 days, 21:06,  2 users,  load average: 9.96, 9.04, 8.94
