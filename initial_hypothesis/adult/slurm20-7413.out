2021-04-15 18:52:10.171715: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
Torch is available: True
torch.cuda.current_device(): 0
torch.cuda.device_count(): 1
torch.cuda.get_device_name(): Tesla T4
[]
batch number: 1
Created directory.
Size of full dataset: (48841, 15)
age               0
workclass         0
fnlwht            0
education         0
education-num     0
marital-status    0
occupation        0
relationship      0
race              0
sex               0
capital-gain      0
capital-loss      0
hours-per-week    0
native-country    0
income            0
dtype: int64
   workclass_Federal-gov  workclass_Local-gov  ...  sex_Female  sex_Male
0                      0                    0  ...           0         1
1                      0                    0  ...           0         1
2                      0                    0  ...           0         1
3                      0                    0  ...           1         0
4                      0                    0  ...           1         0

[5 rows x 98 columns]
   age  education-num  capital-gain  ...  race_White  sex_Female  sex_Male
0   50             13             0  ...           1           0         1
1   38              9             0  ...           1           0         1
2   53              7             0  ...           0           0         1
3   28             13             0  ...           0           1         0
4   37             14             0  ...           1           1         0

[5 rows x 103 columns]
len(idx_train): 36825
len(idx_test): 9207
Training non-private model...
Non-private model training on 20 epochs done in  0:00:16.343232  seconds
Training model -1:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0

Test set: Average loss: 0.3333, Accuracy: 7782/9207 (85%)

Original model accuracy: 0.8452264581296839

Test set: Average loss: 0.4671, Accuracy: 7582/9207 (82%)

Full private model accuracy: 0.8235038557619203
Training model 1060:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 7668:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 8962:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 14448:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 14755:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 15568:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 16044:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 16738:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 18137:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 20415:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0
Training model 27206:
Train Epoch: 20 	(ε = 1.22, δ = 1e-05) for α = 18.0

Test set: Average loss: 0.4767, Accuracy: 7543/9207 (82%)

Model 1060 accuracy: 0.8192679483002063

Test set: Average loss: 0.4603, Accuracy: 7562/9207 (82%)

Model 7668 accuracy: 0.8213315955251439

Test set: Average loss: 0.4579, Accuracy: 7592/9207 (82%)

Model 8962 accuracy: 0.8245899858803084

Test set: Average loss: 0.4702, Accuracy: 7553/9207 (82%)

Model 14448 accuracy: 0.8203540784185945

Test set: Average loss: 0.4595, Accuracy: 7571/9207 (82%)

Model 14755 accuracy: 0.8223091126316933

Test set: Average loss: 0.4504, Accuracy: 7608/9207 (83%)

Model 15568 accuracy: 0.8263277940697296

Test set: Average loss: 0.4539, Accuracy: 7578/9207 (82%)

Model 16044 accuracy: 0.823069403714565

Test set: Average loss: 0.4730, Accuracy: 7548/9207 (82%)

Model 16738 accuracy: 0.8198110133594004

Test set: Average loss: 0.4708, Accuracy: 7551/9207 (82%)

Model 18137 accuracy: 0.820136852394917

Test set: Average loss: 0.4732, Accuracy: 7554/9207 (82%)

Model 20415 accuracy: 0.8204626914304334

Test set: Average loss: 0.4735, Accuracy: 7556/9207 (82%)

Model 27206 accuracy: 0.820679917454111
Training time: 0:05:02.785118
Thu Apr 15 18:57:29 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 460.39       Driver Version: 460.39       CUDA Version: 11.2     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:07.0 Off |                    0 |
| N/A   45C    P0    27W /  70W |      0MiB / 15109MiB |     31%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 18:57:29 up 14 days,  4:55,  2 users,  load average: 2.85, 2.55, 2.17
